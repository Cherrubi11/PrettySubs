<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Orders</title>
<style>
  body { 
    font-family: 'Quicksand', sans-serif; 
    background: #fff0f5; 
    padding: 20px; 
  }
  h1, h2 { 
    font-family: 'Comfortaa', cursive; 
    color: #d63384; 
    text-align: center; 
  }
  .section { 
    margin: 30px 0; 
    padding: 20px; 
    border-radius: 20px; 
    background: #ffe6f0; 
    box-shadow: 0 5px 15px rgba(255,105,180,0.2); 
  }
  .request-item { 
    margin-bottom: 15px; 
    padding: 10px; 
    border-left: 4px solid #ff69b4; 
    background: rgba(255,255,255,0.7); 
    border-radius: 10px; 
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .request-details { flex: 1; }
  button.delete-btn { 
    background: #ff4d6d; 
    border: none; 
    color: white; 
    padding: 8px 12px; 
    border-radius: 8px; 
    cursor: pointer; 
    transition: 0.2s ease;
  }
  button.delete-btn:hover { 
    background: #e6004c; 
  }
</style>
</head>
<body>

<h1>üå∏ Admin Dashboard üå∏</h1>

<div class="section">
  <h2>Free Requests</h2>
  <% if (!requests || requests.length === 0) { %>
    <p>No free requests yet üíï</p>
  <% } else { %>
    <% requests.forEach((r, i) => { %>
      <div class="request-item" data-id="<%= r.id %>" data-type="free">
        <div class="request-details">
          <h3><%= r.name %></h3>
          <p>Category: <%= r.category %></p>
          <p>Request: <%= r.request %></p>
          <p>Date: <%= r.date %></p>
        </div>
        <button class="delete-btn">Delete</button>
      </div>
    <% }) %>
  <% } %>
</div>

<div class="section">
  <h2>Paid Requests</h2>
  <% if (!paidRequests || paidRequests.length === 0) { %>
    <p>No paid requests yet üíñ</p>
  <% } else { %>
    <% paidRequests.forEach((r, i) => { %>
      <div class="request-item" data-id="<%= r.id %>" data-type="paid">
        <div class="request-details">
          <h3><%= r.name %></h3>
          <p>Package: <%= r.package %></p>
          <p>Request: <%= r.request %></p>
          <p>Payment Link: <a href="<%= r.paymentLink %>" target="_blank"><%= r.paymentLink %></a></p>
          <p>Date: <%= r.date %></p>
        </div>
        <button class="delete-btn">Delete</button>
      </div>
    <% }) %>
  <% } %>
</div>

<script>
  document.addEventListener("click", async (e) => {
    if (e.target.classList.contains("delete-btn")) {
      const item = e.target.closest(".request-item");
      const id = item.getAttribute("data-id");
      const type = item.getAttribute("data-type");
      
      try {
        const res = await fetch(`/delete-request/${id}`, { method: "DELETE" });
        if (res.ok) {
          item.remove(); // instantly remove from DOM
        } else {
          alert("‚ùå Could not delete item");
        }
      } catch (err) {
        console.error(err);
        alert("‚ö†Ô∏è Error deleting request");
      }
    }
  });
</script>

</body>
</html>

