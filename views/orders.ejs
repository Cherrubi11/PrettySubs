<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Orders</title>
<style>
  body { 
    font-family: 'Quicksand', sans-serif; 
    background: #fff0f5; 
    padding: 20px; 
  }
  h1, h2 { 
    font-family: 'Comfortaa', cursive; 
    color: #d63384; 
    text-align: center; 
  }
  .section { 
    margin: 30px 0; 
    padding: 20px; 
    border-radius: 20px; 
    background: #ffe6f0; 
    box-shadow: 0 5px 15px rgba(255,105,180,0.2); 
  }
  .request-item { 
    margin-bottom: 15px; 
    padding: 10px; 
    border-left: 4px solid #ff69b4; 
    background: rgba(255,255,255,0.7); 
    border-radius: 10px; 
    position: relative;
  }
  .request-item h3 { 
    margin-bottom: 5px; 
  }
  .request-item p { 
    margin: 3px 0; 
  }
  .delete-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #ff4d6d;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 5px 10px;
    cursor: pointer;
  }
  .delete-btn:hover {
    background: #d63384;
  }
  a { 
    color: #d63384; 
    text-decoration: none; 
  }
  a:hover { 
    text-decoration: underline; 
  }
</style>
</head>
<body>

<h1>ðŸŒ¸ Admin Dashboard ðŸŒ¸</h1>

<div class="section">
  <h2>Free Requests</h2>
  <% if (!requests || requests.length === 0) { %>
    <p>No free requests yet ðŸ’•</p>
  <% } else { %>
    <% requests.forEach(r => { %>
      <div class="request-item" id="request-<%= r.id %>">
        <h3><%= r.name %></h3>
        <p>Category: <%= r.category %></p>
        <p>Request: <%= r.request %></p>
        <p>Date: <%= r.date %></p>
        <button class="delete-btn" onclick="deleteRequest('<%= r.id %>')">Delete</button>
      </div>
    <% }) %>
  <% } %>
</div>

<div class="section">
  <h2>Paid Requests</h2>
  <% if (!paidRequests || paidRequests.length === 0) { %>
    <p>No paid requests yet ðŸ’–</p>
  <% } else { %>
    <% paidRequests.forEach(r => { %>
      <div class="request-item" id="request-<%= r.id %>">
        <h3><%= r.name %></h3>
        <p>Package: <%= r.package %></p>
        <p>Request: <%= r.request %></p>
        <p>Payment Link: <a href="<%= r.paymentLink %>" target="_blank"><%= r.paymentLink %></a></p>
        <p>Date: <%= r.date %></p>
        <button class="delete-btn" onclick="deleteRequest('<%= r.id %>')">Delete</button>
      </div>
    <% }) %>
  <% } %>
</div>

<script>
  async function deleteRequest(id) {
    if (!confirm("Are you sure you want to delete this request?")) return;

    try {
      const response = await fetch(`/delete-request/${id}`, { method: 'DELETE' });
      if (response.ok) {
        const elem = document.getElementById(`request-${id}`);
        if (elem) elem.remove();
      } else {
        alert("Oops! Could not delete the request.");
      }
    } catch (err) {
      console.error(err);
      alert("Something went wrong ðŸ’”");
    }
  }
</script>

</body>
</html>
